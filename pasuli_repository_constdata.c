#include <stdlib.h>
#include "pasuli_cfg.h"
#include "pasuli_repository.h"

#define ID_AND_LENGTH(ID, L) \
	{                        \
		ID, L, 0             \
	}

#define ID_AND_LENGTH_C(ID, L, V) \
	{                             \
		ID, L, V                  \
	}

#define STD1_VALUES 120
#define DINI_VALUES 121
#define CYLINDER_VALUES 122
#define LEMON_VALUES 123
#define SPHERE_VALUES 124
#define TORUS1_VALUES 125
#define PLANAR_ENNEPER_VALUES 126

#define ALL_ONES 255
#define ALL_HALFES 254

// Constants defined so should be divided by 10 to get real (stored) value
#define CONSTANT_TUPLE_10(V1, V2, V3, V4, V5, V6) V1, V2, V3, V4, V5, V6

unsigned char constants_multiplied[] = {
	// STD1
	CONSTANT_TUPLE_10(15, 5, 10, 10, 10, 10),
	// DINI
	CONSTANT_TUPLE_10(10, 2, 0, 0, 0, 0),
	// CYLINDER
	CONSTANT_TUPLE_10(15, 10, 5, 10, 10, 10),
	// LEMON
	CONSTANT_TUPLE_10(20, 10, 0, 0, 0, 0),
	// Sphere
	CONSTANT_TUPLE_10(15, 10, 10, 0, 0, 0),
	// Torus 1
	CONSTANT_TUPLE_10(10, 10, 5, 10, 10, 10),
	// Planar Enneper Surface
	CONSTANT_TUPLE_10(20, 4, 10, 0, 0, 0),
};

#undef CONSTANT_TUPLE_10

unsigned char id_and_length[][3] = {
	ID_AND_LENGTH_C(PLANE, 1, 0),
	ID_AND_LENGTH_C(BOHEMIAN_DOME_SURFACE, 3, ALL_ONES),
	ID_AND_LENGTH(BOYS_SURFACE, 0),
	ID_AND_LENGTH(CROSS_CUP, 0),
	//
	ID_AND_LENGTH_C(DINI_SURFACE, 2, DINI_VALUES),
	ID_AND_LENGTH(ENNEPER_SURFACE, 0),
	ID_AND_LENGTH(HANDKERCHIEF, 0),
	ID_AND_LENGTH_C(KLEIN_BOTTLE_SURFACE, 3, ALL_ONES),
	//
	ID_AND_LENGTH_C(MOEBIUS_BAND, 1, ALL_ONES),
	ID_AND_LENGTH_C(MOEBIUS_BAND2, 3, ALL_ONES),
	ID_AND_LENGTH(MONKEY_SADDLE, 0),
	ID_AND_LENGTH(PLUECKER_CONOID, 0),
	ID_AND_LENGTH(ROMAN_SURFACE, 0),
	//
	ID_AND_LENGTH(SHOE_SURFACE, 0),
	ID_AND_LENGTH(SINE_SURFACE, 0),
	ID_AND_LENGTH(STEINBACH_SCREW, 0),
	ID_AND_LENGTH(WHITNEY_UMBRELLA, 0),
	//
	ID_AND_LENGTH_C(CATENOID, 1, STD1_VALUES),
	ID_AND_LENGTH_C(HELICOID, 1, STD1_VALUES),
	ID_AND_LENGTH_C(PARABOLOID, 2, STD1_VALUES),
	ID_AND_LENGTH_C(HYPERBOLIC_HELICOID, 1, ALL_HALFES),
	//
	ID_AND_LENGTH(FUNNEL, 0),
	ID_AND_LENGTH(TRACTROID, 0),
	ID_AND_LENGTH(CATALANS_SURFACE, 0),
	ID_AND_LENGTH_C(HYPERBOLOID, 2, STD1_VALUES),
	//
	ID_AND_LENGTH(HENNEBERGS_SURFACE, 0),
	ID_AND_LENGTH(SWALLOW_SURFACE, 0),
	ID_AND_LENGTH_C(WALLIS_CONICAL_SURFACE, 3, STD1_VALUES),
	ID_AND_LENGTH(MAEDERS_OWL, 0),
	//
	ID_AND_LENGTH(RICHMOND_SURFACE, 0),
	ID_AND_LENGTH_C(SCHERK_SURFACE, 1, STD1_VALUES),
	ID_AND_LENGTH(COSINE_SURFACE, 0),
	ID_AND_LENGTH(EIGHT_SURFACE, 0),
	//
	ID_AND_LENGTH(JET_SURFACE, 0),
	ID_AND_LENGTH_C(DROP, 2, STD1_VALUES),
	ID_AND_LENGTH(TRIAXIAL_TEARDROP, 0),
	ID_AND_LENGTH_C(PILLOW_SHAPE, 1, STD1_VALUES),
	//
	ID_AND_LENGTH(FISH_SURFACE, 0),
	ID_AND_LENGTH_C(HORN, 3, STD1_VALUES),
	ID_AND_LENGTH(BENT_HORNS, 0),
	ID_AND_LENGTH(HYPERBOLIC_OCTAHEDRON, 0),
	//
	ID_AND_LENGTH(PSEUDO_CROSS_CAP, 0),
	ID_AND_LENGTH_C(CRESENT, 3, STD1_VALUES),
	ID_AND_LENGTH(STILETTO_SURFACE, 0),
	ID_AND_LENGTH(KUENS_SURFACE, 0),
	//
	ID_AND_LENGTH_C(TREFOIL_KNOTS, 2, STD1_VALUES),
	ID_AND_LENGTH(TRANGULOID_TREFOIL, 0),
	ID_AND_LENGTH(CROWN, 0),
	ID_AND_LENGTH(TWISTED_PIPE_SURFACE, 0),
	//
	ID_AND_LENGTH(LOOP, 0),
	ID_AND_LENGTH_C(DUPIN_CYCLIDE, 4, STD1_VALUES),
	ID_AND_LENGTH_C(GUIMARD_SURFACE, 3, STD1_VALUES),
	ID_AND_LENGTH_C(MENNS_SURFACE, 1, ALL_ONES),
	//
	ID_AND_LENGTH_C(MILK_BAG, 1, ALL_ONES),
	ID_AND_LENGTH(TRIAXIAL_TRITORUS, 0),
	ID_AND_LENGTH(VERRILL_SURFACE, 0),
	ID_AND_LENGTH(ZINDLERS_CONOID, 1),
	//
	ID_AND_LENGTH(FOLIUM, 0),
	ID_AND_LENGTH(LEMNISCAPE, 0),
	ID_AND_LENGTH(TRIPLE_POINT_TWIST, 1),
	ID_AND_LENGTH(TRASHCAN, 2),
	//
	ID_AND_LENGTH(SPRING1, 4),
	ID_AND_LENGTH(SPRING2, 3),
	ID_AND_LENGTH_C(CONE, 1, ALL_ONES),
	ID_AND_LENGTH(EGG, 3),
	//
	ID_AND_LENGTH_C(ISOLATOR, 3, STD1_VALUES),
	ID_AND_LENGTH(HYPERBOLIC_PARABOLOID, 0),
	ID_AND_LENGTH_C(FACING_SNAIL, 1, STD1_VALUES),
	ID_AND_LENGTH_C(PAPER_BAG, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(JEENER_KLEIN_SURFACE, 3, STD1_VALUES),
	ID_AND_LENGTH_C(BONAN_JEENER_KLEIN_SURFACE, 2, STD1_VALUES),
	ID_AND_LENGTH_C(KLEIN_CYCLOID, 3, STD1_VALUES),
	ID_AND_LENGTH(DOUBLE_CONE, 0),
	//
	ID_AND_LENGTH(HOLE_DISC, 0),
	ID_AND_LENGTH(PISOT_TRIAXIAL, 0),
	ID_AND_LENGTH(TRIAXIAL_HEXATORUS, 0),
	ID_AND_LENGTH(TWISTED_HEART, 0),
	//
	ID_AND_LENGTH_C(HOLE_DISCUS, 2, STD1_VALUES),
	ID_AND_LENGTH(DISC, 0),
	ID_AND_LENGTH_C(WAVES, 3, STD1_VALUES),
	ID_AND_LENGTH_C(SINE_WAVE, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(DROP_SURFACE, 1, STD1_VALUES),
	ID_AND_LENGTH_C(ASTROIDAL_ELLIPSOID, 3, ALL_ONES),
	ID_AND_LENGTH_C(COSINE_WAVE, 2, STD1_VALUES),
	ID_AND_LENGTH_C(SPIRAL_WAVE, 3, STD1_VALUES),
	ID_AND_LENGTH_C(BELL, 2, STD1_VALUES),
	ID_AND_LENGTH_C(BELL_POLAR, 3, STD1_VALUES),
	//
	ID_AND_LENGTH_C(BELL_WAVE, 3, STD1_VALUES),
	ID_AND_LENGTH(SOUCOUPOID, 0),
	ID_AND_LENGTH(ENNEPER_SURFACE_POLAR, 0),
	ID_AND_LENGTH_C(SINE_CONE, 2, STD1_VALUES),
	//
	ID_AND_LENGTH(SPINNER, 0),
	ID_AND_LENGTH_C(FRESNEL, 3, STD1_VALUES),
	ID_AND_LENGTH_C(TREFOIL_KNOTS2, 4, STD1_VALUES),
	ID_AND_LENGTH_C(BOW_CURVE, 1, STD1_VALUES),
	//
	ID_AND_LENGTH_C(TRIPLE_CORK_SCREW1, 4, STD1_VALUES),
	ID_AND_LENGTH_C(TRIPLE_CORK_SCREW2, 6, STD1_VALUES),
	ID_AND_LENGTH_C(TRIPLE_CORK_SCREW3, 4, STD1_VALUES),
	ID_AND_LENGTH(BICORN_SURFACE, 0),
	//
	ID_AND_LENGTH_C(PIRIFORM_SURFACE, 3, STD1_VALUES),
	ID_AND_LENGTH_C(KAPPA_SURFACE, 1, STD1_VALUES),
	ID_AND_LENGTH_C(BULLET_NOSE, 2, STD1_VALUES),
	ID_AND_LENGTH_C(SIEVERT_SURFACE, 1, STD1_VALUES),
	//
	ID_AND_LENGTH(COSINE_SURFACE2, 0),
	ID_AND_LENGTH_C(CYLINDER, 1, ALL_ONES),
	ID_AND_LENGTH_C(EPIZYKLOID_CYLINDER, 4, CYLINDER_VALUES),
	ID_AND_LENGTH_C(HYPOZYKLOID_CYLINDER, 4, CYLINDER_VALUES),
	//
	ID_AND_LENGTH_C(LEMNISKATE_CYLINDER, 2, ALL_ONES),
	ID_AND_LENGTH_C(STROPHOIDE_CYLINDER, 2, ALL_ONES),
	ID_AND_LENGTH_C(ZISSOIDE_CYLINDER, 2, ALL_ONES),
	ID_AND_LENGTH_C(VERSIERA_AGNESI_CYLINDER, 2, ALL_ONES),
	//
	ID_AND_LENGTH_C(GAUSS_CYLINDER, 3, ALL_ONES),
	//Fruits
	ID_AND_LENGTH(KIDNEY_SURFACE, 0),
	ID_AND_LENGTH(APPLE_SURFACE, 0),
	ID_AND_LENGTH_C(APPLE2_SURFACE, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(LEMON_SURFACE, 2, LEMON_VALUES),
	// Shells & snails
	ID_AND_LENGTH_C(CORNUCOPIA, 2, STD1_VALUES), // TODO
	ID_AND_LENGTH_C(SNAIL, 2, STD1_VALUES),		 // TODO
	ID_AND_LENGTH_C(SEASHELL, 4, STD1_VALUES),	 // TODO
	//
	ID_AND_LENGTH(SNAIL_SURFACE, 0),
	ID_AND_LENGTH_C(SNAILS, 7, STD1_VALUES),		// TODO
	ID_AND_LENGTH(PSEUDOHELICERAS_SUBCATENATUM, 0), // TODO R
	ID_AND_LENGTH(ASTROCERAS, 0),					// TODO R
	//
	ID_AND_LENGTH(BELLEROPHINA, 0),	   // TODO R
	ID_AND_LENGTH(EUHOPLITES, 0),	   // TODO R
	ID_AND_LENGTH(NAUTILUS, 0),		   // TODO R
	ID_AND_LENGTH(NATICA_STELLATA, 0), // TODO R
	//
	ID_AND_LENGTH(MYA_ARENARIA, 0), // TODO R
	// Sphere
	ID_AND_LENGTH(SPHERE, 0),
	ID_AND_LENGTH_C(ELLIPSOID, 3, SPHERE_VALUES),
	ID_AND_LENGTH(SPHERE_V, 0),
	//
	ID_AND_LENGTH(SPHERE_UV, 0),
	ID_AND_LENGTH(PSEUDOSPHERE, 0),
	ID_AND_LENGTH_C(TWISTED_SPHERE, 2, ALL_ONES),
	ID_AND_LENGTH(OPEN_SPHERE, 0),
	//
	ID_AND_LENGTH(WAVE_SPHERE, 0),
	// Spirals
	ID_AND_LENGTH_C(ARCHIMEDIC_SPIRAL, 1, ALL_ONES),
	ID_AND_LENGTH_C(HYPERBOLIC_SPIRAL, 1, ALL_ONES),
	ID_AND_LENGTH_C(FERMAT_SPIRAL, 1, ALL_ONES),
	//
	ID_AND_LENGTH_C(TANH_SPIRAL, 2, ALL_ONES),
	ID_AND_LENGTH_C(LOG_SPIRAL, 2, ALL_ONES),
	// Torus
	ID_AND_LENGTH_C(TORUS, 2, STD1_VALUES),
	ID_AND_LENGTH_C(EIGHT_TORUS, 1, ALL_ONES),
	//
	ID_AND_LENGTH_C(ELLIPTIC_TORUS, 1, ALL_ONES),
	ID_AND_LENGTH(SADDLE_TORUS, 0),
	ID_AND_LENGTH_C(ANTISYMMETRIC_TORUS, 3, STD1_VALUES),
	ID_AND_LENGTH_C(TWISTED_EIGHT_TORUS, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(UMBILLIC_TORUS, 2, STD1_VALUES),
	ID_AND_LENGTH_C(WAVE_TORUS, 4, STD1_VALUES),
	ID_AND_LENGTH_C(BRAIDED_TORUS, 4, ALL_ONES),
	ID_AND_LENGTH(LIMPET_TORUS, 0),
	//
	ID_AND_LENGTH_C(STRANGLED_TORUS, 3, ALL_ONES),
	ID_AND_LENGTH_C(ASTROID_TORUS, 2, ALL_ONES),
	ID_AND_LENGTH_C(TRICUSPOID_TORUS_1, 2, STD1_VALUES),
	ID_AND_LENGTH_C(TRICUSPOID_TORUS_2, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(NEPHROID_TORUS_1, 2, STD1_VALUES),
	ID_AND_LENGTH_C(NEPHROID_TORUS_2, 2, STD1_VALUES),
	ID_AND_LENGTH_C(LEMNISKATE_TORUS_1, 2, STD1_VALUES),
	ID_AND_LENGTH_C(LEMNISKATE_TORUS_2, 2, STD1_VALUES),
	//
	ID_AND_LENGTH_C(EPIZYKLOID_TORUS_1, 4, TORUS1_VALUES),
	ID_AND_LENGTH_C(EPIZYKLOID_TORUS_2, 4, TORUS1_VALUES),
	ID_AND_LENGTH_C(HYPOZYKLOID_TORUS_1, 4, TORUS1_VALUES),
	ID_AND_LENGTH_C(HYPOZYKLOID_TORUS_2, 4, TORUS1_VALUES),
	//
	ID_AND_LENGTH_C(PIRIFORM_TORUS_1, 2, ALL_ONES),
	ID_AND_LENGTH_C(PIRIFORM_TORUS_2, 2, ALL_ONES),
	ID_AND_LENGTH_C(BICORN_TORUS_1, 2, ALL_ONES),
	ID_AND_LENGTH_C(BICORN_TORUS_2, 2, ALL_ONES),
	//
	ID_AND_LENGTH_C(CARDIOID_TORUS_1, 2, ALL_ONES),
	ID_AND_LENGTH_C(CARDIOID_TORUS_2, 2, ALL_ONES),
	ID_AND_LENGTH_C(CASSINIAN_OVAL_TORUS_1, 3, ALL_ONES),
	ID_AND_LENGTH_C(CASSINIAN_OVAL_TORUS_2, 3, ALL_ONES),
	//
	ID_AND_LENGTH_C(GERONO_LEMNISKATE_TORUS_1, 2, ALL_ONES),
	ID_AND_LENGTH_C(GERONO_LEMNISKATE_TORUS_2, 2, ALL_ONES),
	ID_AND_LENGTH_C(CURLY_TORUS_1, 4, ALL_ONES),
	ID_AND_LENGTH_C(CURLY_TORUS_2, 4, ALL_ONES),
	//
	ID_AND_LENGTH_C(SPIRAL_TORUS, 4, ALL_ONES),
	ID_AND_LENGTH_C(TORUS_KNOT, 5, ALL_ONES),
	ID_AND_LENGTH_C(GEAR_TORUS, 4, ALL_ONES),
	// END
	// NEW ONES after Feb 22, 2021
	ID_AND_LENGTH(PEANO_SURFACE, 0),
	ID_AND_LENGTH_C(PEANO_SURFACE2, 4, ALL_ONES),
	ID_AND_LENGTH_C(VASE_HEAD, 2, ALL_ONES),
	ID_AND_LENGTH(PLUECKER_CONOID2, 0),
	ID_AND_LENGTH_C(MONKEY_SADDLE2, 1, ALL_ONES),
	ID_AND_LENGTH(BOYS_SURFACE2, 0),
	ID_AND_LENGTH_C(SKIDAN_RULED_SURFACE, 3, ALL_ONES),
	ID_AND_LENGTH(SCHERK_SURFACE2, 0),
	ID_AND_LENGTH_C(CATALANS_SURFACE2, 1, ALL_ONES),
	ID_AND_LENGTH(WRINKLE_SPHERE, 0),
	ID_AND_LENGTH_C(WRINKLE_SPHERE2, 1, 20),
	ID_AND_LENGTH_C(SNAIL2, 1, ALL_ONES),
	ID_AND_LENGTH(KLEIN_BOTTLE_SURFACE2, 0),
	ID_AND_LENGTH(FOUR_INTERSECTING_DISCS, 0),
	ID_AND_LENGTH_C(KAI_WING_FUNG_SURFACE1, 1, ALL_ONES),
	ID_AND_LENGTH(KAI_WING_FUNG_SURFACE2, 0),
	ID_AND_LENGTH(RICHMOND_SURFACE2, 0),
	ID_AND_LENGTH_C(RICHMOND_SURFACE3, 1, 2),
	ID_AND_LENGTH(ENNEPER_SURFACE2, 0),
	ID_AND_LENGTH(ENNEPER_SURFACE3, 0),
	ID_AND_LENGTH_C(WAVY_ENNEPER_SURFACE, 1, 2),
	ID_AND_LENGTH(TWISTED_RIBBON, 0),
	ID_AND_LENGTH_C(PLANAR_ENNEPER_SURFACE, 3, PLANAR_ENNEPER_VALUES),
	ID_AND_LENGTH(CAYLEY_SURFACE, 0),
	ID_AND_LENGTH(ROMAN_SURFACE2, 0),
	ID_AND_LENGTH(MOEBIUS_BAND3, 0),
	ID_AND_LENGTH_C(VIRICH_CYCLIC_SURFACE, 4, ALL_ONES),
	ID_AND_LENGTH_C(PSEUDODEVELOPABLE_HELICOID, 2, ALL_ONES),
	ID_AND_LENGTH(CROSS_CUP2, 0),
	ID_AND_LENGTH_C(CROSS_CUP3, 1, ALL_ONES),
	ID_AND_LENGTH(CUSPIDAL_BUTTERFLY, 0),
	ID_AND_LENGTH(CUSPIDAL_LIPS, 0),
	ID_AND_LENGTH(CUSPIDAL_EDGE, 0),
	ID_AND_LENGTH(CUSPIDAL_BEAKS, 0),
	ID_AND_LENGTH(DING_DONG_SURFACE, 0),
	ID_AND_LENGTH(TOOTH_SURFACE, 0),
	ID_AND_LENGTH(LAWSON_BOTTLE, 0),
	ID_AND_LENGTH(GOBLET, 0),
	ID_AND_LENGTH(BOWTIE, 0),
	ID_AND_LENGTH_C(HORNLET_SURFACE, 4, ALL_ONES),
	ID_AND_LENGTH_C(BALLS_CYLINDROID, 1, ALL_ONES),
	ID_AND_LENGTH_C(EPITROCHOIDAL_SURFACE, 2, ALL_ONES),
	ID_AND_LENGTH_C(MORIN_SURFACE, 2, ALL_ONES),
	ID_AND_LENGTH_C(CROSSED_TROUGH_SURFACE, 1, ALL_ONES),
	ID_AND_LENGTH_C(HECTOR_GUINARDS_SURFACE, 3, ALL_ONES),
	ID_AND_LENGTH_C(AGNESI_CURL, 2, ALL_ONES),
	ID_AND_LENGTH(SPINNING_TOP1, 0),
	ID_AND_LENGTH(SPINNING_TOP2, 0),
	ID_AND_LENGTH(KISS_SURFACE, 0),
	ID_AND_LENGTH(NEOVIUS_SURFACE, 0),
	ID_AND_LENGTH_C(RULED_ROTOR_CYLINDROID, 3, ALL_ONES),
	ID_AND_LENGTH_C(PARABOLIC_HUMMING_TOP, 2, 1),
};

#include <stdio.h>
#include <string.h>

void testDefaultConstants()
{
	size_t numberOf = 256;

	unsigned char *pStates = malloc(numberOf);

	memset(pStates, 0, numberOf);

	unsigned int alreadyDefined =
		sizeof(id_and_length) / (3 * sizeof(char));

	printf("#defined = %d\n", alreadyDefined);

	for (int idx = 0; idx < alreadyDefined; idx++)
	{
		int id = id_and_length[idx][0];

		if (((id <= 0) || (id > 255)))
		{
			printf("Invalid surface at index %d, value %d", idx, id);
			continue;
		}
		if (pStates[id] > 0)
		{
			printf("Constants already defined for surface %d", id);
		}
		pStates[id] += 1;
	}

	for (int idx = 1; idx < NUMB_OF_SURFACES; idx++)
	{
		if (pStates[idx] == 0)
		{
			printf("Constants not yet defined for surface %d\n", idx);
		}
	}

	free(pStates);
}

int findDefaultConstants(unsigned int id, double *pConstants, int size)
{
	unsigned int alreadyDefined =
		sizeof(id_and_length) / (3 * sizeof(char));

	if (id >= 255)
	{
		// Not found
		return -1;
	}

	for (size_t idx = 0; idx < alreadyDefined; idx++)
	{
		int idInArray = id_and_length[idx][0];
		if (id == idInArray)
		{
			int length = id_and_length[idx][1];
			if (length > 0)
			{
				if (length < size)
				{
					// Not enough space to store
					return -2;
				}
				int typeOrValue = id_and_length[idx][2];

				if (typeOrValue == ALL_ONES || typeOrValue == ALL_HALFES)
				{
					double v = typeOrValue == ALL_ONES ? 1.0 : 0.5;

					for (int j = 0; j < length; j++)
					{
						pConstants[j] = v;
					}
				}

				if (typeOrValue >= STD1_VALUES && typeOrValue <= TORUS1_VALUES)
				{
					int idx = (typeOrValue - STD1_VALUES) * 6;

					if (idx > sizeof(constants_multiplied) / sizeof(char) ||
						length > 6)
					{
						// INTERNAL error
						return -3;
					}

					for (int j = 0; j < length; j++)
					{
						pConstants[j] = (constants_multiplied[j] * 1.0) / 10.0;
					}
				}
				else
				{
					for (int j = 0; j < length; j++)
					{
						pConstants[j] = typeOrValue * 1.0;
					}
				}
			}
			return length;
		}
	}

	// Not found
	return -1;
}

#undef STD1_VALUES
#undef DINI_VALUES
#undef CYLINDER_VALUES
#undef LEMON_VALUES
#undef SPHERE_VALUES
#undef TORUS1_VALUES

#define PASULI_IMPLEMENTED(ID, IMPL_MASK) \
	{                                     \
		ID, IMPL_MASK                     \
	}

#define IMPL_POS 0x1
#define IMPL_UD 0x2
#define IMPL_VD 0x4
#define IMPL_N 0x8
#define IMPL_UUD 0x10
#define IMPL_UVD 0x20
#define IMPL_VVD 0x40
#define IMPL_ALL 0x7F
#define IMPL_ONLY_POS_UD_VD (IMPL_POS | IMPL_UD | IMPL_VD)
#define IMPL_NORMAL_BY_CROSS_PRODUCT 0x80
#define IMPL_NO_BEGIN_NORMAL IMPL_ONLY_POS_UD_VD | IMPL_NORMAL_BY_CROSS_PRODUCT

#define IMPL_NO_2DERIV 0x0F

#define IMPL_MINUS(ALL_VAL, TO_SUBTRACT) (ALL_VAL - (TO_SUBTRACT))

unsigned char implementationStates[][2] = {
	// Cylinder
	PASULI_IMPLEMENTED(CYLINDER, IMPL_ALL),
	PASULI_IMPLEMENTED(EPIZYKLOID_CYLINDER, IMPL_ALL),
	PASULI_IMPLEMENTED(GAUSS_CYLINDER, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(HYPOZYKLOID_CYLINDER, IMPL_ALL),
	PASULI_IMPLEMENTED(LEMNISKATE_CYLINDER, IMPL_MINUS(IMPL_ALL, IMPL_UUD)),
	PASULI_IMPLEMENTED(STROPHOIDE_CYLINDER, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(VERSIERA_AGNESI_CYLINDER, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(ZISSOIDE_CYLINDER, IMPL_NO_BEGIN_NORMAL),
	// Fruits
	PASULI_IMPLEMENTED(APPLE_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(APPLE2_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(KIDNEY_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(LEMON_SURFACE, IMPL_ALL),
	// Shells
	PASULI_IMPLEMENTED(CORNUCOPIA, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SEASHELL, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(SNAIL_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(SNAIL, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(SNAILS, IMPL_NO_BEGIN_NORMAL),
	//Following Snails are special 'instances' of Snails
	PASULI_IMPLEMENTED(ASTROCERAS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(BELLEROPHINA, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EUHOPLITES, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(MYA_ARENARIA, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(NATICA_STELLATA, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(NAUTILUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(PSEUDOHELICERAS_SUBCATENATUM, IMPL_NO_BEGIN_NORMAL),
	// Spheres
	PASULI_IMPLEMENTED(ELLIPSOID, IMPL_ALL),
	PASULI_IMPLEMENTED(OPEN_SPHERE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(PSEUDOSPHERE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SPHERE_UV, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SPHERE_V, IMPL_ALL),
	PASULI_IMPLEMENTED(SPHERE, IMPL_ALL),
	PASULI_IMPLEMENTED(TWISTED_SPHERE, IMPL_ALL),
	PASULI_IMPLEMENTED(WAVE_SPHERE, IMPL_ALL),
	// Spirals
	PASULI_IMPLEMENTED(ARCHIMEDIC_SPIRAL, IMPL_ALL),
	PASULI_IMPLEMENTED(FERMAT_SPIRAL, IMPL_ALL),
	PASULI_IMPLEMENTED(HYPERBOLIC_SPIRAL, IMPL_ALL),
	PASULI_IMPLEMENTED(LOG_SPIRAL, IMPL_ALL),
	PASULI_IMPLEMENTED(TANH_SPIRAL, IMPL_NO_2DERIV),
	// Surfaces
	PASULI_IMPLEMENTED(BELL_POLAR, IMPL_ALL),
	PASULI_IMPLEMENTED(BELL_WAVE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(BELL, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(BENT_HORNS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(BICORN_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(BOHEMIAN_DOME_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(BONAN_JEENER_KLEIN_SURFACE, IMPL_POS),
	//
	PASULI_IMPLEMENTED(BOW_CURVE, IMPL_ALL),
	PASULI_IMPLEMENTED(BOYS_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(BULLET_NOSE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(CATALANS_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(CATENOID, IMPL_ALL),
	PASULI_IMPLEMENTED(CONE, IMPL_ALL),
	PASULI_IMPLEMENTED(COSINE_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(COSINE_SURFACE2, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(COSINE_WAVE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(CRESENT, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CROSS_CUP, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CROWN, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(DINI_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(DISC, IMPL_ALL),
	PASULI_IMPLEMENTED(DOUBLE_CONE, IMPL_ALL),
	PASULI_IMPLEMENTED(DROP_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(DROP, IMPL_ALL),
	PASULI_IMPLEMENTED(DUPIN_CYCLIDE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EGG, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(EIGHT_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(ENNEPER_SURFACE_POLAR, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(ENNEPER_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(FACING_SNAIL, IMPL_ALL),
	PASULI_IMPLEMENTED(FISH_SURFACE, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(FOLIUM, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(FRESNEL, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(FUNNEL, IMPL_ALL),
	PASULI_IMPLEMENTED(GUIMARD_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(HANDKERCHIEF, IMPL_ALL),
	PASULI_IMPLEMENTED(HELICOID, IMPL_ALL),
	PASULI_IMPLEMENTED(HENNEBERGS_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(HOLE_DISC, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(HOLE_DISCUS, IMPL_ALL),
	PASULI_IMPLEMENTED(HORN, IMPL_ALL),
	PASULI_IMPLEMENTED(HYPERBOLIC_HELICOID, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(HYPERBOLIC_OCTAHEDRON, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(HYPERBOLIC_PARABOLOID, IMPL_ALL),
	PASULI_IMPLEMENTED(HYPERBOLOID, IMPL_ALL),
	PASULI_IMPLEMENTED(ISOLATOR, IMPL_ALL),
	PASULI_IMPLEMENTED(JEENER_KLEIN_SURFACE, IMPL_POS),
	//
	PASULI_IMPLEMENTED(JET_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(KAPPA_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(KLEIN_BOTTLE_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(KLEIN_CYCLOID, IMPL_POS),
	//
	PASULI_IMPLEMENTED(KUENS_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(LEMNISCAPE, IMPL_POS),
	PASULI_IMPLEMENTED(LOOP, IMPL_ALL),
	PASULI_IMPLEMENTED(MAEDERS_OWL, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(MENNS_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(MILK_BAG, IMPL_ALL),
	PASULI_IMPLEMENTED(MOEBIUS_BAND, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(MOEBIUS_BAND2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(MONKEY_SADDLE, IMPL_ALL),
	PASULI_IMPLEMENTED(PAPER_BAG, IMPL_ALL),
	PASULI_IMPLEMENTED(PARABOLOID, IMPL_ALL),
	PASULI_IMPLEMENTED(PILLOW_SHAPE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(PLANE, IMPL_ALL),
	PASULI_IMPLEMENTED(PIRIFORM_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(PISOT_TRIAXIAL, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(PLUECKER_CONOID, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(PSEUDO_CROSS_CAP, IMPL_ALL),
	PASULI_IMPLEMENTED(RICHMOND_SURFACE, IMPL_NO_BEGIN_NORMAL), //Check again ?
	PASULI_IMPLEMENTED(ROMAN_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SCHERK_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(SHOE_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(SIEVERT_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(SINE_CONE, IMPL_ALL),
	PASULI_IMPLEMENTED(SINE_SURFACE, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(SINE_WAVE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SOUCOUPOID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SPINNER, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(SPIRAL_WAVE, IMPL_NO_2DERIV),
	//
	PASULI_IMPLEMENTED(SPRING1, IMPL_ALL),
	PASULI_IMPLEMENTED(SPRING2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(STEINBACH_SCREW, IMPL_ALL),
	PASULI_IMPLEMENTED(STILETTO_SURFACE, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(SWALLOW_SURFACE, IMPL_ALL),
	PASULI_IMPLEMENTED(TRACTROID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(TRANGULOID_TREFOIL, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRASHCAN, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(TREFOIL_KNOTS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TREFOIL_KNOTS2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRIAXIAL_HEXATORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRIAXIAL_TEARDROP, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(TRIAXIAL_TRITORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRIPLE_CORK_SCREW1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRIPLE_CORK_SCREW2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRIPLE_CORK_SCREW3, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(TRIPLE_POINT_TWIST, IMPL_ALL),
	PASULI_IMPLEMENTED(TWISTED_HEART, IMPL_POS),
	PASULI_IMPLEMENTED(TWISTED_PIPE_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(VERRILL_SURFACE, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(WALLIS_CONICAL_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(WAVES, IMPL_ALL),
	PASULI_IMPLEMENTED(WHITNEY_UMBRELLA, IMPL_ALL),
	PASULI_IMPLEMENTED(ZINDLERS_CONOID, IMPL_NO_2DERIV),
	// Torus surfaces
	PASULI_IMPLEMENTED(ANTISYMMETRIC_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(ASTROID_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(BICORN_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(BICORN_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(BRAIDED_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CARDIOID_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CARDIOID_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CASSINIAN_OVAL_TORUS_1, IMPL_POS),
	//
	PASULI_IMPLEMENTED(CASSINIAN_OVAL_TORUS_2, IMPL_POS),
	PASULI_IMPLEMENTED(CURLY_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CURLY_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EIGHT_TORUS, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(ELLIPTIC_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EPIZYKLOID_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EPIZYKLOID_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(GEAR_TORUS, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(GERONO_LEMNISKATE_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(GERONO_LEMNISKATE_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(HYPOZYKLOID_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(HYPOZYKLOID_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(LEMNISKATE_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(LEMNISKATE_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(LIMPET_TORUS, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(NEPHROID_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(NEPHROID_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(PIRIFORM_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(PIRIFORM_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(SADDLE_TORUS, IMPL_POS),
	//
	PASULI_IMPLEMENTED(SPIRAL_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(STRANGLED_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TORUS_KNOT, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TORUS, IMPL_ALL),
	//
	PASULI_IMPLEMENTED(TRICUSPOID_TORUS_1, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TRICUSPOID_TORUS_2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TWISTED_EIGHT_TORUS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(UMBILLIC_TORUS, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(WAVE_TORUS, IMPL_NO_BEGIN_NORMAL),
	//
	// New ones
	//
	PASULI_IMPLEMENTED(AGNESI_CURL, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(ASTROIDAL_ELLIPSOID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(BALLS_CYLINDROID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(BOWTIE, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(BOYS_SURFACE2, IMPL_POS),
	PASULI_IMPLEMENTED(CATALANS_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CAYLEY_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(CROSS_CUP2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(CROSS_CUP3, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CROSSED_TROUGH_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(CUSPIDAL_BEAKS, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(CUSPIDAL_BUTTERFLY, IMPL_NO_2DERIV),
	//
	PASULI_IMPLEMENTED(CUSPIDAL_EDGE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(CUSPIDAL_LIPS, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(DING_DONG_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(ENNEPER_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(ENNEPER_SURFACE3, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(EPITROCHOIDAL_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(FOUR_INTERSECTING_DISCS, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(GOBLET, IMPL_NO_2DERIV),
	//
	PASULI_IMPLEMENTED(HECTOR_GUINARDS_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(HORNLET_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(KAI_WING_FUNG_SURFACE1, IMPL_POS),
	PASULI_IMPLEMENTED(KAI_WING_FUNG_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(KISS_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(KLEIN_BOTTLE_SURFACE2, IMPL_POS),
	PASULI_IMPLEMENTED(LAWSON_BOTTLE, IMPL_POS),
	PASULI_IMPLEMENTED(MOEBIUS_BAND3, IMPL_POS),
	//
	PASULI_IMPLEMENTED(MONKEY_SADDLE2, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(MORIN_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(NEOVIUS_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(PARABOLIC_HUMMING_TOP, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(PEANO_SURFACE, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(PEANO_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(PLANAR_ENNEPER_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(PLUECKER_CONOID2, IMPL_NO_2DERIV),
	//
	PASULI_IMPLEMENTED(PSEUDODEVELOPABLE_HELICOID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(RICHMOND_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(RICHMOND_SURFACE3, IMPL_POS),
	PASULI_IMPLEMENTED(ROMAN_SURFACE2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(RULED_ROTOR_CYLINDROID, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SCHERK_SURFACE2, IMPL_POS),
	PASULI_IMPLEMENTED(SKIDAN_RULED_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(SNAIL2, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(SPINNING_TOP1, IMPL_NO_2DERIV),
	PASULI_IMPLEMENTED(SPINNING_TOP2, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(TOOTH_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(TWISTED_RIBBON, IMPL_NO_2DERIV),
	//
	PASULI_IMPLEMENTED(VASE_HEAD, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(VIRICH_CYCLIC_SURFACE, IMPL_POS),
	PASULI_IMPLEMENTED(WAVY_ENNEPER_SURFACE, IMPL_NO_BEGIN_NORMAL),
	PASULI_IMPLEMENTED(WRINKLE_SPHERE, IMPL_NO_BEGIN_NORMAL),
	//
	PASULI_IMPLEMENTED(WRINKLE_SPHERE2, IMPL_NO_BEGIN_NORMAL),
};

#undef PASULI_IMPLEMENTED

unsigned char getImplementationState(unsigned int id)
{
	unsigned int alreadyImplemented =
		sizeof(implementationStates) / (2 * sizeof(char));

	printf("#implemented/checked = %d\n", alreadyImplemented);

	if ((id <= 0) || (id > NUMB_OF_SURFACES))
	{
		return 0;
	}

	for (int i = 0; i < alreadyImplemented; i++)
	{
		if (implementationStates[i][0] == id)
		{
			return implementationStates[i][1];
		}
	}

	return 0;
}